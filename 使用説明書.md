# ISOP - 規格対応書類更新AIエージェント 使用説明書

## 目次
1. [概要](#概要)
2. [システム要件](#システム要件)
3. [インストール手順](#インストール手順)
4. [初期設定](#初期設定)
5. [使用方法](#使用方法)
6. [機能詳細](#機能詳細)
7. [トラブルシューティング](#トラブルシューティング)
8. [よくある質問](#よくある質問)

---

## 概要

ISOPは、ISOやプライバシーマークなどの規格文書の更新を支援するAIエージェントです。既存の規格関連書類と新規格内容を比較し、AIが自動的に書類を更新し、差分レポートを生成します。

### 主な特徴
- 🤖 **AI自動更新**: GPT-5-miniを使用した高度な書類更新
- 💬 **対話型修正**: AIからの質問に回答して書類を調整
- 📊 **差分レポート**: 変更前後の詳細な差分を可視化
- 📋 **直感的UI**: タブ分けとサイドメニューで使いやすいインターフェース
- 📝 **詳細ログ**: 処理の全段階を記録・確認可能

---

## システム要件

### 必須要件
- **OS**: Windows 10/11, macOS 10.15+, Ubuntu 18.04+
- **Python**: 3.11以上
- **メモリ**: 8GB以上（推奨16GB）
- **ストレージ**: 2GB以上の空き容量
- **インターネット**: OpenAI APIへの接続が必要

### 推奨要件
- **CPU**: 4コア以上
- **メモリ**: 16GB以上
- **ストレージ**: SSD推奨

---

## インストール手順

### 1. ファイルのダウンロード
1. ISOPのファイルを任意のフォルダに展開
2. コマンドプロンプト（Windows）またはターミナル（Mac/Linux）を開く
3. 展開したフォルダに移動

### 2. 起動ファイルの実行

#### Windowsの場合
```cmd
start_isop.bat
```

#### Mac/Linuxの場合
```bash
chmod +x start_isop.sh
./start_isop.sh
```

### 3. 自動インストール
起動ファイルが自動的に以下を実行します：
- Python環境の確認
- 依存関係のインストール
- アプリケーションの起動

---

## 初期設定

### 1. OpenAI APIキーの設定

#### 方法1: .envファイルを使用
1. プロジェクトルートに`.env`ファイルを作成
2. 以下の内容を記述：
```
OPENAI_API_KEY=your_openai_api_key_here
CHROMA_DB_PATH=./chroma_db
```

#### 方法2: 環境変数を設定
```bash
# Windows
set OPENAI_API_KEY=your_openai_api_key_here

# Mac/Linux
export OPENAI_API_KEY=your_openai_api_key_here
```

### 2. OpenAI APIキーの取得
1. [OpenAI公式サイト](https://platform.openai.com/)にアクセス
2. アカウントを作成・ログイン
3. API Keysページで新しいキーを生成
4. 生成されたキーをコピーして設定

---

## 使用方法

### 1. アプリケーションの起動
1. 起動ファイルを実行
2. ブラウザが自動的に開く（通常は http://localhost:8501）
3. サイドバーでメニューを選択

### 2. 書類のアップロード

#### 既存書類のアップロード
1. 「📄 書類アップロード」を選択
2. 「📋 既存書類」タブをクリック
3. 「既存書類をアップロード」ボタンをクリック
4. PDF、DOCX、TXTファイルを選択
5. アップロード完了を確認

#### 新規格内容のアップロード
1. 「🆕 新規格内容」タブをクリック
2. 「新規格内容をアップロード」ボタンをクリック
3. PDF、TXTファイルを選択
4. アップロード完了を確認

### 3. AI処理の実行
1. 「🤖 AI処理」を選択
2. 「🔄 処理実行」タブをクリック
3. 「🚀 処理を開始」ボタンをクリック
4. 処理の進捗を確認

### 4. AI対話（必要に応じて）
1. 「💬 AI対話」タブをクリック
2. 「🆕 新しい対話を開始」をクリック
3. AIからの質問に回答
4. 回答を送信して書類更新に反映

### 5. 差分レポートの確認
1. 「📊 差分レポート」を選択
2. 生成された差分レポートを確認
3. 必要に応じてダウンロード

---

## 機能詳細

### 🏠 ホーム
- **概要**: アプリケーションの機能説明
- **クイックスタート**: 基本的な使用手順
- **対応規格**: サポートされている規格の一覧

### 📄 書類アップロード
- **ファイル形式**: PDF、DOCX、TXT対応
- **プレビュー機能**: アップロードしたファイルの内容を確認
- **ファイル情報**: サイズ、形式、アップロード時刻を表示
- **履歴管理**: アップロード履歴の確認（開発中）

### 🤖 AI処理
- **処理ステップ**: 4段階の処理を可視化
  1. 📄 書類解析
  2. 🔍 ベクトル化
  3. 🤖 AI書き換え
  4. 📊 差分生成
- **AI対話**: 書類更新に関する質問と回答
- **処理ログ**: 詳細なログ記録と表示

### 📊 差分レポート
- **差分表示**: 変更前後の詳細な差分
- **ダウンロード**: 新書類と差分レポートのダウンロード
- **形式**: マークダウン形式で出力

### ⚙️ 設定
- **API設定**: OpenAI APIキーとモデル選択
- **データベース設定**: ChromaDBパスの設定
- **システム情報**: バージョン情報とシステム状態
- **ログ管理**: ログのエクスポート機能

---

## トラブルシューティング

### よくある問題と解決方法

#### 1. OpenAI APIキーエラー
**症状**: "OpenAI APIキーが設定されていません"と表示される
**解決方法**:
1. `.env`ファイルが正しく作成されているか確認
2. APIキーが正しく記述されているか確認
3. 環境変数が正しく設定されているか確認

#### 2. Python環境エラー
**症状**: "Pythonがインストールされていません"と表示される
**解決方法**:
1. Python 3.11以上をインストール
2. PATH環境変数にPythonを追加
3. コマンドプロンプトで`python --version`を実行して確認

#### 3. 依存関係エラー
**症状**: "依存関係のインストールに失敗しました"と表示される
**解決方法**:
1. インターネット接続を確認
2. pipを最新版に更新: `pip install --upgrade pip`
3. 仮想環境の使用を検討

#### 4. ファイルアップロードエラー
**症状**: ファイルがアップロードできない
**解決方法**:
1. ファイル形式が対応しているか確認（PDF、DOCX、TXT）
2. ファイルサイズが適切か確認（推奨: 100MB以下）
3. ファイルが破損していないか確認

#### 5. AI処理エラー
**症状**: AI処理中にエラーが発生する
**解決方法**:
1. OpenAI APIキーが有効か確認
2. インターネット接続を確認
3. ファイル内容が適切か確認
4. ログを確認して詳細なエラー情報を確認

### ログの確認方法
1. 「🤖 AI処理」→「📋 処理ログ」を選択
2. ログレベルを選択（ALL、INFO、WARNING、ERROR）
3. 詳細ログを表示してエラー情報を確認
4. 必要に応じてログをエクスポート

---

## よくある質問

### Q1: どのような規格に対応していますか？
A: ISO 27001、ISO 9001、プライバシーマークなど、テキストベースの規格文書に対応しています。新しい規格にも対応可能です。

### Q2: ファイルサイズの制限はありますか？
A: 推奨は100MB以下です。大きなファイルは処理時間が長くなる可能性があります。

### Q3: 処理時間はどのくらいですか？
A: ファイルサイズと内容によりますが、通常は数分から数十分です。大きなファイルは1時間以上かかる場合があります。

### Q4: 生成された書類の精度はどのくらいですか？
A: AIによる自動更新ですが、必ず人間による確認をお勧めします。特に重要な部分は手動でチェックしてください。

### Q5: データのセキュリティは大丈夫ですか？
A: アップロードされたファイルはローカルに一時保存されます。機密情報を含む場合は、使用後にファイルを削除してください。

### Q6: 複数の書類を同時に処理できますか？
A: 現在は1つの書類ずつ処理します。複数書類の処理は今後のバージョンで対応予定です。

### Q7: 処理を中断できますか？
A: ブラウザを閉じるか、Ctrl+Cで処理を中断できます。ただし、処理中のデータは失われる可能性があります。

### Q8: 生成された書類の形式は何ですか？
A: マークダウン形式で出力されます。必要に応じてWordやPDFに変換してください。

---

## サポート

### 技術サポート
- **GitHub**: バグ報告や機能要望
- **ドキュメント**: 詳細な技術仕様書
- **ログ**: エラー時の詳細情報

### 使用上の注意
- 重要な書類は必ずバックアップを取ってから処理してください
- 生成された書類は人間による確認をお勧めします
- 機密情報を含む場合は、使用後にファイルを削除してください

---

## 更新履歴

### v2.0.0 (2024年12月)
- UI/UXの大幅改善（タブ分け、サイドメニュー）
- AI対話機能の追加
- ログ機能の強化
- エラーハンドリングの改善
- GPT-5-mini対応

### v1.0.0 (2024年11月)
- 初回リリース
- 基本的な書類更新機能
- 差分レポート生成
- Streamlit UI
